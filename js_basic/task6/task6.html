<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>task6</title>
    <script>
        // 任务一：内置对象API运用练习，补充function中的代码 
        // 提示： reduce、for循环、 foreach
        // 1. 求一个数组中所有元素的乘积，试着用不同的方法来做，尽量让代码简洁易读
        // function getResult(arr) {
        //     let ret = 1;
        //     arr.forEach(x => {
        //         ret *= x;
        //     });
        //     return ret;
        // }
        // function getResult(arr) {
        //     let ret = 1;
        //     for (let i in arr) ret *= arr[i];
        //     return ret;
        // }
        function getResult(arr) {
            return arr.reduce((mul, x) => { return mul * x; });
        }
        console.log(getResult([1, 2, 3])); // 输出6


        // 2. 转换数据， 参考API: Object.assign() 或者 Array.prototype.forEach()
        function convertListToMap(optionsList) {
            //...
        }
        var optionsList = [
            {
                value: 'man',
                label: '男',
            },
            {
                value: 'woman',
                label: '女'
            }
        ]
        var optionsMap = convertListToMap(optionsList);
        console.log(optionsMap);
        /**
        输出：
        {
        man: '男',
        woman: '女'
        }
        **/

        // ### 任务二：闭包和计时事件
        // 说出下面的内容输出什么
        // 如果和设想的不一样， 想想这个程序每个语句的运行顺序？ 不能理解的话参考扩展资料中的【并发模型与事件循环 - MDN】 后面将会有解决这个问题的练习
        for (var i = 0; i < 5; i++) {
            setTimeout(function () {
                console.log(i);
            }, 0);
        }
        // 输出五个五


        // 能否使用setTimeout来实现setInterval? 提示：利用闭包。有点难， 1小时没写出来就放弃吧~等参考答案。

        function mySetInterval(callback, time) {
            let id;
            function perm() {
                callback();
                id = setTimeout(perm, time);
            }
            perm();
            return id;
        }

        function myClearInterval(id) {
            clearTimeout(id);
        };

        let timerId = mySetInterval(()=>{
            console.log('B');
        }, 1000);

        myClearInterval(timerId);

        // ### 任务三： 运用bind、call、apply
        // 修改这段代码， 使得异步输出0~4
        for (var i = 0; i < 5; i++) {
            setTimeout(function(i) {
                console.log(i);
            }.bind(null, i), 0);
        }

        // 回顾一下前面的原型，如何将Array.prototype.map作用在字符串上用一行代码实现让一个字符串的每个字符出现两次
        function repeatEveryCharTwice(str) {
            return Array.prototype.map.call(str, x => { return x + x; }).join('');
        }
        var a = 'abcd';
        console.log(repeatEveryCharTwice(a)); // 输出aabbccdd
    </script>
</head>

<body>

</body>

</html>